<!DOCTYPE html>
<html>
<head>
    <title>Clothing Store Management</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f4f4f4; 
        }
        h1 { 
            color: #333; 
            text-align: center; 
            margin-bottom: 30px;
        }
        h3 {
            color: #1e3a8a;
            border-left: 5px solid #1e3a8a;
            padding-left: 10px;
        }
        input, select, button { 
            margin: 5px; 
            padding: 8px; 
            border: 1px solid #ccc; 
            border-radius: 5px;
        }
        button {
            cursor: pointer;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            font-weight: bold;
        }
        button:hover { opacity: 0.9; }
        .btn-green { background: #16a34a; color: white; }
        .btn-blue { background: #2563eb; color: white; }
        .btn-orange { background: #f97316; color: white; }
        .btn-red { background: #dc2626; color: white; }
        .section { 
            margin-bottom: 30px; 
            background: #fff; 
            padding: 15px; 
            border-radius: 8px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 10px; 
            background: #fff; 
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: center; 
        }
        th { 
            background: #2563eb; 
            color: white; 
        }
        tr:nth-child(even) { background: #f9fafb; }
        tr:hover { background: #e0f2fe; }
        .low-stock { 
            color: red; 
            font-weight: bold; 
        }
        .dashboard { 
            background: linear-gradient(90deg, #2563eb, #7c3aed); 
            color: white; 
            padding: 15px; 
            border-radius: 8px; 
            text-align: center; 
            font-size: 16px; 
            font-weight: bold;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <h1>Clothing Store Management</h1>

    <!-- Dashboard Summary -->
    <div class="dashboard" id="dashboard"></div>

    <div class="section">
        <h3>Add / Edit Item</h3>
        <input type="hidden" id="editIndex" />
        <input type="text" id="name" placeholder="Clothing Name" />
        <input type="text" id="size" placeholder="Size (S, M, L...)" />
        <input type="text" id="color" placeholder="Color" />
        <select id="category">
            <option value="Shirt">Shirt</option>
            <option value="Pants">Pants</option>
            <option value="Jacket">Jacket</option>
            <option value="Other">Other</option>
        </select>
        <input type="number" id="price" placeholder="Price" />
        <input type="number" id="quantity" placeholder="Quantity" />
        <button class="btn-green" onclick="addOrUpdateItem()">Save Item</button>
    </div>

    <div class="section">
        <h3>Search & Filter</h3>
        <input type="text" id="searchKeyword" placeholder="Enter name or size" />
        <select id="filterCategory">
            <option value="">All Categories</option>
            <option value="Shirt">Shirt</option>
            <option value="Pants">Pants</option>
            <option value="Jacket">Jacket</option>
            <option value="Other">Other</option>
        </select>
        <button class="btn-blue" onclick="searchItem()">Search</button>
        <div id="searchResults"></div>
    </div>

    <div class="section">
        <h3>Sell Item</h3>
        <input type="text" id="sellName" placeholder="Item name" />
        <input type="number" id="sellQty" placeholder="Quantity" />
        <input type="number" id="discount" placeholder="Discount %" />
        <input type="text" id="customerName" placeholder="Customer Name" />
        <button class="btn-blue" onclick="sellItem()">Sell</button>
    </div>

    <div class="section">
        <h3>Stock</h3>
        <button class="btn-blue" onclick="viewStock()">Refresh Stock</button>
        <div id="stockList"></div>
    </div>

    <div class="section">
        <h3>Sales Report</h3>
        <button class="btn-blue" onclick="viewSales()">View Sales</button>
        <div id="salesReport"></div>
    </div>

    <script>
        let data = JSON.parse(localStorage.getItem("storeData")) || [];
        let sales = JSON.parse(localStorage.getItem("salesData")) || [];

        function saveData() {
            localStorage.setItem("storeData", JSON.stringify(data));
            localStorage.setItem("salesData", JSON.stringify(sales));
        }

        function updateDashboard() {
            const totalItems = data.length;
            const totalStock = data.reduce((sum, i) => sum + i.quantity, 0);
            const stockValue = data.reduce((sum, i) => sum + (i.price * i.quantity), 0);
            const totalRevenue = sales.reduce((sum, s) => sum + s.total, 0);

            document.getElementById("dashboard").innerHTML = `
                <b>Total Items:</b> ${totalItems} | 
                <b>Total Stock:</b> ${totalStock} | 
                <b>Stock Value:</b> ₹${stockValue} | 
                <b>Total Revenue:</b> ₹${totalRevenue}
            `;
        }

        function addOrUpdateItem() {
            const editIndex = document.getElementById("editIndex").value;
            const name = document.getElementById("name").value;
            const size = document.getElementById("size").value;
            const color = document.getElementById("color").value;
            const category = document.getElementById("category").value;
            const price = parseFloat(document.getElementById("price").value);
            const quantity = parseInt(document.getElementById("quantity").value);

            if (!name || !size || !color || isNaN(price) || isNaN(quantity)) {
                alert("Please fill all fields correctly.");
                return;
            }

            const newItem = { name, size, color, category, price, quantity };

            if (editIndex) {
                data[editIndex] = newItem;
                alert("Item updated!");
            } else {
                data.push(newItem);
                alert("Item added!");
            }

            saveData();
            resetForm();
            viewStock();
        }

        function resetForm() {
            document.getElementById("editIndex").value = "";
            document.getElementById("name").value = "";
            document.getElementById("size").value = "";
            document.getElementById("color").value = "";
            document.getElementById("price").value = "";
            document.getElementById("quantity").value = "";
        }

        function viewStock() {
            const stockDiv = document.getElementById("stockList");
            stockDiv.innerHTML = "";

            if (data.length === 0) {
                stockDiv.innerHTML = "No stock available.";
                return;
            }

            let table = `<table>
                <tr>
                    <th>#</th><th>Name</th><th>Size</th><th>Color</th><th>Category</th>
                    <th>Price</th><th>Qty</th><th>Actions</th>
                </tr>`;

            data.forEach((item, index) => {
                const lowStockClass = item.quantity <= 5 ? "low-stock" : "";
                table += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td>${item.size}</td>
                        <td>${item.color}</td>
                        <td>${item.category}</td>
                        <td>₹${item.price}</td>
                        <td class="${lowStockClass}">${item.quantity}</td>
                        <td>
                            <button class="btn-orange" onclick="editItem(${index})">Edit</button>
                            <button class="btn-red" onclick="deleteItem(${index})">Delete</button>
                        </td>
                    </tr>`;
            });

            table += "</table>";
            stockDiv.innerHTML = table;
            updateDashboard();
        }

        function editItem(index) {
            const item = data[index];
            document.getElementById("editIndex").value = index;
            document.getElementById("name").value = item.name;
            document.getElementById("size").value = item.size;
            document.getElementById("color").value = item.color;
            document.getElementById("category").value = item.category;
            document.getElementById("price").value = item.price;
            document.getElementById("quantity").value = item.quantity;
        }

        function deleteItem(index) {
            if (confirm("Are you sure you want to delete this item?")) {
                data.splice(index, 1);
                saveData();
                viewStock();
            }
        }

        function searchItem() {
            const keyword = document.getElementById("searchKeyword").value.toLowerCase();
            const filterCategory = document.getElementById("filterCategory").value;
            const resultDiv = document.getElementById("searchResults");
            resultDiv.innerHTML = "";

            const results = data.filter(item =>
                (item.name.toLowerCase().includes(keyword) || item.size.toLowerCase().includes(keyword)) &&
                (filterCategory === "" || item.category === filterCategory)
            );

            if (results.length === 0) {
                resultDiv.innerHTML = "No matching items found.";
                return;
            }

            results.forEach(item => {
                const div = document.createElement("div");
                div.className = "item";
                div.innerText = `${item.name} | Size: ${item.size} | Color: ${item.color} | Category: ${item.category} | Price: ₹${item.price} | Qty: ${item.quantity}`;
                resultDiv.appendChild(div);
            });
        }

        function sellItem() {
            const name = document.getElementById("sellName").value.toLowerCase();
            const qty = parseInt(document.getElementById("sellQty").value);
            const discount = parseFloat(document.getElementById("discount").value) || 0;
            const customerName = document.getElementById("customerName").value || "Unknown";

            const item = data.find(i => i.name.toLowerCase() === name);

            if (!item) {
                alert("Item not found.");
                return;
            }

            if (qty > item.quantity) {
                alert("Not enough stock.");
                return;
            }

            item.quantity -= qty;

            let total = qty * item.price;
            total = total - (total * discount / 100);

            sales.push({ 
                name: item.name, 
                qty, 
                price: item.price, 
                discount, 
                total, 
                customer: customerName, 
                date: new Date().toLocaleString() 
            });

            saveData();
            alert(`Sold ${qty} ${item.name}(s) to ${customerName}. Total: ₹${total}`);
            viewStock();
        }

        function viewSales() {
            const reportDiv = document.getElementById("salesReport");
            reportDiv.innerHTML = "";

            if (sales.length === 0) {
                reportDiv.innerHTML = "No sales recorded yet.";
                return;
            }

            let table = `<table>
                <tr>
                    <th>Date</th><th>Item</th><th>Qty</th><th>Price</th><th>Discount</th><th>Total</th><th>Customer</th>
                </tr>`;

            sales.forEach(s => {
                table += `
                    <tr>
                        <td>${s.date}</td>
                        <td>${s.name}</td>
                        <td>${s.qty}</td>
                        <td>₹${s.price}</td>
                        <td>${s.discount}%</td>
                        <td>₹${s.total}</td>
                        <td>${s.customer}</td>
                    </tr>`;
            });

            table += "</table>";
            reportDiv.innerHTML = table;
        }

        // Load stock on page load
        window.onload = () => {
            viewStock();
            updateDashboard();
        };
    </script>

</body>
</html>
